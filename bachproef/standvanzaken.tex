\chapter{\IfLanguageName{dutch}{Stand van zaken}{State of the art}}
\label{ch:stand-van-zaken}

\section{Wat is virtualisatie}
\subsection{De geschiedenis van virtualisatie}

Abstract beschreven is virtualisatie een term die verwijst naar de abstractie van computerbronnen. Het doel van een virtuele computer omgeving is het gebruik van hulpbronnen/resources te verbeteren door middel van een geïntegreerd besturingsplatform voor gebruikers en applicaties gebaseerd op aggregatie van heterogene en autonome middelen. Tegenwoordig is virtualisatie op meerdere niveaus belangrijk om systeembeveiliging, betrouwbaarheid en beschikbaarheid te verbeteren en garanderen alsook het verminderen van kosten en zorgen voor meer flexibiliteit. Virtualisatie is snel uitgegroeid tot een go-to-technologie voor het verhogen van de efficiëntie. Virtualisatie biedt een enorme flexibiliteit, zo kunnen ongelijksoortige architecturen (Linux, MacOS, Windows,...) op één enkele machine tegelijkertijd worden ingezet zonder interferentie. \autocite{Radhwan2013}

Virtualisatie is een techniek waarin alle fysieke kenmerken van computerbronnen verborgen worden waarvan applicaties, andere systemen en toepassingen gebruik kunnen maken. Het is een softwareabstractielaag tussen de hardware en het besturingssysteem en de toepassingen die erbovenop draaien. Dit wordt een hypervisor of virtual machine monitor(VMM) genoemd. Doordat de hardwarebronnen door de VMM/hypervisor worden gebruikt en niet door de host, is het mogelijk meerdere besturingssystemen te draaien op dezelfde hardware. Al deze verschillende besturingssystemen worden dan virtuele machines (VM's) genoemd. “Virtualiteit” verschilt alleen van “werkelijkheid” in de formele wereld, terwijl zij eigenlijk een soortgelijke essentie of werking bezit. In de computerwereld wordt een virtuele omgeving waargenomen als die van een echte omgeving door zowel toepassingsprogramma's als de rest van de wereld, hoewel de onderliggende mechanismen formeel wel verschillend zijn. \autocite{Radhwan2013}

Virtuele machines zijn al meer dan 50 jaar in de computergemeenschap, ontwikkeld in 1960 door IBM Corporation, oorspronkelijk was dit om een grote mainframe computer te verdelen in verschillende instanties. Deze functie werd uitgevonden omdat het onderhoud van de grotere mainframe systemen omslachtig werd. Door het systeem te partitioneren, maakt het het mogelijk meerdere processen en toepassingen gelijktijdig te kunnen draaien, waardoor de efficiëntie en onderhoudskosten van de omgevingen verminderen. Onder toezicht en leiding van Professor Fernando J. Corbató beter bekend als 'Corby', zijn de ingenieurs en programmeurs begonnen met CTSS, de “Compatible Time-Sharing System”. \autocite{Radhwan2013}

De CTSS-supervisor leverde een aantal virtuele machines, allemaal een IBM 7094. Een van deze virtuele machines was de achtergrondmachine en had toegang tot tapedrives(Een tapedrive is ene opslag apparaat). De andere virtuele machines waren voorgrondmachines. Deze machines konden normale 7094-machinetaal draaien met een snelheid van 7094 en konden ook een extra instructie uitvoeren, die een groot aantal 'supervisorservices' opriep. Deze 'services' omvatten de terminal-I/O en systeem-I/O. Programma's kunnen worden geschreven voor de voorgrondmachine in elke taal die beschikbaar is voor de 7094. Er werden bibliotheken beschikbaar gesteld zodat compilertalen zoals MAD gebruik konden maken van die 'supervisorservices'. CTSS leverde een bestandssysteem dat elke geregistreerde gebruiker een aparte map met bestanden gaf. \autocite{VanVleck2015}

De belangrijkste kenmerken van CTSS waren virtuele machines, hardware isolatie van gebruikers van de supervisor en van elkaar, en een bestandssysteem per gebruiker. Omdat de virtuele gebruikersmachine dezelfde architectuur en instructieset ondersteunde als de 7094, kon CTSS een groot aantal applicaties ondersteunen die oorspronkelijk waren ontwikkeld voor de FMS-batchomgeving bij MIT en elders. \autocite{VanVleck2015}

CTSS-software omvatte niet alleen de supervisor, maar ook een reeks voorgrond-opdrachten en subroutine bibliotheken. Veel van deze  opdrachten lezen en schrijven bestanden van het bestandssysteem van de gebruiker. Zo las bijvoorbeeld de MAD-compiler een bestand met de broncode van een programma en schreef hetzelfde bestand met instructies in BSS(block starting symbol) formaat. Het grootste deel van de MAD-opdrachten op de voorgrond waren gelijk aan de MAD-compiler op de achtergrond op de FMS systeemtape, met de toevoeging van een wrapper voor het afhandelen van opdrachtprompt opties en vervangingen voor de invoer- en uitvoerroutines om bestanden te lezen en te schrijven in plaats van tape, en om foutmeldingen naar de terminal van de gebruiker te schrijven. \autocite{VanVleck2015}

In 1973 demonstreren Srodowa en Bates hoe je een virtuele machine kan maken op de IBM OS/360s. Ze beschrijven het gebruik van de IBM's virtuele machine monitor, de hypervisor om virtuele machines te maken en het efficiënt toewijzen van geheugen, opslag en I/O. Beiden hebben betrekking op onderwerpen die vandaag nog steeds worden bediscussieerd: prestatievermindering, capaciteit, CPU-toewijzing en opslag beveiliging. In 1974 concludeert Goldberg dat het merendeel van de toenmalige computersystemen geen virtuele machines ondersteunen. De weinige virtuele machines die op dat moment operationeel zijn, bijvoorbeeld CP-67, gebruiken lastige en inadequate technieken vanwege ongeschikte architecturen. Goldberg stelt de “Hardware Virtualizer” voor, waarin een virtuele machine rechtstreeks zou communiceren met hardware in plaats van door de hostsoftware te gaan. Bijna 30 jaar later zijn brancheanalisten enthousiast over de aankondiging van hardware-architecturen die virtuele machines efficiënt kunnen ondersteunen. Zowel AMD als Intel onthulden specificaties voor Pacifica en Vanderpool chiptechnologieën met speciale virtualisatie-ondersteuningsfuncties. \autocite{Radhwan2013}

De jaren tachtig en begin jaren negentig brachten het 'Distributed computing', wat een techniek is waarbij rekentaken niet door één enkele computer worden uitgevoerd,  met zich mee naar de datacenters. Gecentraliseerd computergebruik en virtuele machines werden vervangen door stand-alone servers met specifieke taken: databank, web, applicaties, e-mail. Na aanzienlijke investeringen in gedistribueerde architecturen, is een hernieuwde focus op virtuele machines als aanvullende oplossing voor serverconsolidatieprojecten en datacenter beheerinitiatieven weer opgedoken. De virtuele machine is dus gemaakt op de mainframe. Het is pas onlangs geïntroduceerd op de middenklasse. Technologische vooruitgang in hardware en software maakt virtuele machines stabiel, betaalbaar en biedt enorme waarde, mits een juiste implementatie. \autocite{Jeff2009}

Sinds begin 2000 is de opkomst van VMware hun VMware Workstation sterk gestegen. VMware werkt met een “Hosted Architecture”, dit wil zeggen dat de host een operating system nodig heeft zoals Windows of Linux. Om de complexe mix van prestaties, draagbaarheid, implementatiegemak, enz. te optimaliseren, fungeert het product zowel als een virtuele Machine Monitor(VMM) (rechtstreeks in gesprek met de hardware) als  een applicatie die bovenop het hostbesturingssysteem draait. Dit laatste zorgt er voor dat de VMM niet moet omgaan met een groot aantal apparaten beschikbaar op de computers. \autocite{Singh2004}

Het meest essentiële onderdeel van die virtualisatie is dus de Hypervisor, en wordt ook wel de Virtual Machine Monitor genoemd. De Hypervisor creëert een virtueel platform op de host om daarop meerdere gast besturingssystemen te draaien. Op deze manier kunnen meerdere dezelfde of verschillende exemplaren van een besturingssysteem draaien, en de hardwarebronnen delen die door de host worden aangeboden. Datacenters gebruiken tegenwoordig virtualisatie om abstractie te maken van de fysieke hardware, en deze bronnen aan gebruikers of klanten aan te bieden in de vorm van agile, schaalbare, geconsolideerde virtuele machines. Hoewel de technologie en de gebruiksredenen geëvolueerd zijn, blijft de kernbetekenis van virtualisatie hetzelfde: één host besturingssysteem in staat stellen om meerdere onafhankelijke besturingssystemen tegelijkertijd te laten draaien. \autocite{Oracle2012} 

\subsection{Verschillende typen virtualisatie}

Virtualisatie maakt een scheiding van onderliggende hardware mogelijk, wat ervoor zorgt dat je op een hoger niveau bewerkingen kan uitvoeren. Virtualisatietechnologie kan worden onderverdeeld in de volgende: 

\subsubsection{Full virtualisatie}

In full virtualisatie is de hardware-interface die wordt aangeboden aan de hypervisor bijna dezelfde als die wordt geboden door het fysieke toestel. Dit betekent dat er voor virtualisatie weinig tot geen wijziging nodig is aan de besturingssystemen en applicaties als deze compatibel zijn met de hardware van het fysieke toestel. Deze virtualisatie kan worden onderverdeeld in zowel “Bare-metal virtualisatie” als “Hosted virtualisatie”. Bij bare-metal virtualisatie is er geen hostbesturingssysteem, dit wil zeggen dat de hypervisor rechtstreeks draait op de onderliggende hardware. Hosted virtualisatie wil zeggen dat het hostbesturingssysteem elk algemeen besturingssysteem kan zijn, zoals Windows, zoals Linux, etc. waarop de hypervisor draait. Deze virtualisatie heeft een extra softwarelaag die in het gast besturingssysteem draait en aan de hand van hulpprogramma's het mogelijk maakt om tijdens het gebruik van het gast besturingssysteem, toch bestanden te delen met de host. \autocite{Kedia2013}

\subsubsection{Para virtualisatie}

Paravirtualisatie of para-virtualisatie is een virtualisatietechniek die een software-interface presenteert aan de virtuele machines die vergelijkbaar is, maar niet identiek, aan de onderliggende hardware/software interface. Het voordeel van deze techniek is dat het de overheadkosten voor virtualisatie vermindert en betere prestaties levert. \autocite{Kedia2013}

\subsubsection{Operating system virtualisatie}

De kernel staat meerdere geïsoleerde besturingssystemen toe. Deze instanties draaien op een bestaand besturingssysteem en geven een reeks bibliotheken weer waarmee applicaties communiceren, waardoor ze de illusie krijgen dat ze worden uitgevoerd op een machine die speciaal voor het gebruik ervan bedoeld is. Deze virtualisatie staat beter bekend als container virtualisatie, wat later nog aan bod zal komen. \autocite{Kedia2013}

\subsubsection{Desktop virtualisatie}

Desktop virtualisatie is een mechanisme om een PC omgeving met centrale applicaties vanaf een centrale server weer te geven. Het stelt gebruikers in staat applicaties voor verschillende besturingssystemen op een enkele host uit te voeren. Het biedt flexibiliteit om de applicaties en clients te verplaatsen wanneer nodig. \autocite{Kedia2013}

\subsubsection{Server virtualisatie}

Bij server virtualisatie wordt basishardware gevirtualiseerd, waardoor gast besturingssystemen die er op draaien zonder de nood van de gehele operating system kunnen opereren. Servervirtualisatie is het proces waarbij een fysieke server wordt opgedeeld in meerdere unieke en geïsoleerde virtuele servers. \autocite{Kedia2013}

\subsubsection{Applicatie virtualisatie}

Bij deze virtualisatie kan een gebruiker een servertoepassing lokaal draaien met behulp van lokale bronnen zonder de applicatie volledig lokaal te installeren. Het biedt elke gebruiker een geïsoleerde virtuele applicatieomgeving die fungeert als een laag tussen de host en het besturingssysteem. Een voorbeeld van deze soort virtualisatie is een Java Virtual Machine(JVM), aangezien het staat tussen het besturingssysteem en de java-applicatiecode. \autocite{Kedia2013} 

\subsubsection{Storage virtualisatie}

Opslag virtualisatie is een techniek waarbij de opslag van gegevens uit een fysieke opslag wordt opgehaald en over het netwerk wordt verspreid. Dit is een vorm van resource-virtualisatie. Dit wordt vaak gebruikt in een Storage Area Network(SAN). \autocite{Kedia2013}

\subsubsection{Network virtualisatie}

Netwerk virtualisatie is het proces waarbij hard- en softwarebronnen gecombineerd worden tot een virtueel netwerk als één enkele verzameling bronnen. Het zorgt voor een beter infrastructuur gebruik, zoals het hergebruik van poorten en fysieke bronnen, voor meerdere andere netwerkbronnen zoals hosts, virtuele machines, routers, switches etc. Zo helpt het ook bij verlagen van de kosten door netwerkbronnen te delen. \autocite{Kedia2013}

\subsubsection{Resource virtualisatie}

Resource virtualisatie wordt beschouwd als opslagvolumes, namespaces en de netwerkbronnen in een gevirtualiseerd systeem. Alle onderdelen kunnen samen een grotere pool van bronnen worden en zo kan één enkele bron, zoals schrijfruimte, ook worden opgedeeld in een aantal kleinere en gemakkelijk toegankelijke bronnen. \autocite{Kedia2013}

\subsection{Container virtualisatie}

\subsubsection{Wat is container virtualisatie}

Containergebaseerde virtualisatie is een lichtere benadering van virtualisatie met behulp van de host-kernel om meerdere virtuele omgevingen te draaien. Deze virtuele omgevingen worden meestal benoemd als containers. Containergebaseerde virtualisatie virtualiseert op het besturingssysteem niveau, en laat dus toe om meerdere applicaties te draaien zonder redundante host-kernels van andere machines. De containers zien eruit als normale processen van de buitenkant, die bovenop de kernel draaien die gedeeld wordt met de host. Ze bieden een geïsoleerde omgeving met de nodige middelen om applicaties uit te voeren. Deze middelen worden gedeeld met de host of afzonderlijk per container ter beschikking gesteld. \autocite{Thanh2015}

\subsubsection{Verschil tussen containers en virtuele machines}
Containergebaseerde virtualisatie zorgt voor sommige voordelen tegenover een hypervisor-gebaseerde virtualisatie. Ten eerst zorgt een containergebaseerde virtualisatie voor een grotere dichtheid van virtuele omgevingen. Dit komt omdat een container geen volledig besturingssysteem heeft, de grootte en nodige middelen zijn ook minder om een applicatie in een container te draaien. Met als resultaat dat meerdere containergebaseerde virtuele machines opgezet kunnen worden op dezelfde machines t.o.v. traditionele virtuele machines. Ten tweede zorgen containers voor een betere performance. \autocite{Ruiz2015}

Deze studies tonen aan dat de performance van containergebaseerde virtualisatie beter is dan met een hypervisor-gebaseerde virtualisatie in de meeste gevallen. Echter, desondanks het genoemde voordeel is containergebaseerde virtualisatie niet in staat om een verschil in virtuele omgevingen te ondersteunen, zoals een hypervisor dat wel kan. De oorzaak hiervan is, dat containers hetzelfde type moeten zijn als de host. Zo kan bijvoorbeeld een Windows host niet draaien op een Linux host. Aan de hand van een hypervisor-gebaseerde virtuele machine kan dat wel, waardoor je zowel Windows als Linux containers op een Linux host kan draaien. \autocite{Ruiz2015}

\subsubsection{Kubernetes}
Kubernetes is een draagbaar, uitbreidbaar, opensource platform voor het beheren van gecontaineriseerde workloads en services, dat zowel manuele configuratie als automatisering mogelijk maakt. \autocite{Kubernetes2021}

De kracht van Kubernetes is het uitvoeren van workloads op meerdere servers. Het is één van de beste tools als het gaat om containerclusterbeheer. Het voert de juiste containers op het juiste moment uit, schaalt ze op en neer op basis van belasting, lost hardware- of containerstoringen op en beheert netwerken en opslag. \autocite{Rancher2020}

Origineel ontwikkeld door Google, geïnspireerd door een decennia van kennis door het uitrollen van schaalbare en betrouwbare systemen in containers door applicatie georiënteerde APIs. Sinds de introductie in 2014 is Kubernetes één van de grootste en meest populaire open source projecten in de wereld. Het is de standaard API geworden voor het bouwen van cloud-native applicaties, present in bijna elke publieke cloud. Kubernetes is een bewezen infrastructuur voor gedistribueerde systemen dat geschikt is voor cloud-native ontwikkelaars van alle schalen, zo kan het gaan over een cluster van een aantal Raspberry Pi's tot een warenhuis met de nieuwste computers. Het zorgt voor de nodige software om succesvol betrouwbare en schaalbare systemen op te zetten. \autocite{Burns2019}


\subsubsection{Alternatief voor Kubernetes}
Hoewel er veel voordelen zijn voor het gebruik van Kubernetes, denk maar aan documentatie en support van de community, is het niet mis om de alternatieven te bekijken. Amazon Elastic Container Service, Mirantis Kubernetes Engine (Docker Enterprise) zijn hier goede voorbeelden van. Daar dit onderzoek gaat over monitoring zal hier verder geen vergelijking plaatsvinden.

\subsubsection{Docker}
Docker is een source-platform waarop applicaties worden uitgevoerd en het proces gemakkelijker te ontwikkelen en distribueren is. De applicaties die in Docker gebouwd zijn, worden met alle ondersteunende afhankelijkheden verpakt in een zogenaamde container. De containers blijven op een geïsoleerde manier draaien bovenop de kernel van het besturingssysteem. De extra abstractielaag kan invloed hebben op de prestaties. Hoewel containervirtualisatie al meer dan 10 jaar bestaat, is Docker, een relatief nieuwe technologie, zonder twijfel één van de beste omdat het capaciteiten heeft dat voorgaande technologieën niet hadden. \autocite{Rad2017}

In eerste instantie biedt Docker de mogelijkheid om containers te maken en te controleren. Deze applicaties kunnen dan makkelijk in een containers gestoken worden. Daarnaast kunnen deze gevirtualiseerde applicaties makkelijk overal worden gebruikt zonder enige wijziging. Tenslotte kan Docker gemakkelijk samenwerken met externe programma's die helpen bij het opstellen en beheren van Docker containers. \autocite{Rad2017}

\subsubsection{Alternatief voor Docker}
\subsubsection{Hoe werken Kubernetes en Docker samen}
%TODO hoe werkt kubernetes en docker (refereer naar Detemmerman Cedric)

\section{Monitoring}
\subsection{Wat is monitoring}

\subsection{De mogelijkheden in monitoring}
\subsection{Wat is het nut/belang van monitoring in het lessenpakket}

%TODO onderzoeken welke tools veel gebruikt worden(marktonderzoek)
%TODO welke tools zijn er om te monitoren